{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/obsever/array.js","../src/obsever/dep.js","../src/obsever/index.js","../src/state.js","../src/compiler/parser.js","../src/compiler/generate.js","../src/compiler/index.js","../src/obsever/scheduler.js","../src/obsever/watcher.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/create-element.js","../src/render.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["// 工具方法\nexport function isObject(obj) {\n  return typeof obj === \"object\" && obj !== null;\n}\n\n// 应用策略模式\nlet strats = {};\n// 生命周期常量 （写几个示例一下 没写全 反正都统一处理的）\nconst LIFECYCLE_HOOKS = [\n  \"beforeCreate\",\n  \"created\",\n  \"beforeMount\",\n  \"mounted\",\n  \"beforeUpdate\",\n  \"updated\",\n];\n/**\n * desc 生命周期函数合并方法\n * @param {Function} parentVal 父级生命周期值\n * @param {Function} childVal 子级生命周期值\n * @returns {Array} 生命周期函数合并后的数组\n */\nfunction mergeHook(parentVal, childVal) {\n  // 如果有子级 且 有父级 则父级合并子级\n  if (childVal) {\n    if (parentVal) {\n      return parentVal.concat(childVal);\n    }\n    // 如果没有父级则直接返回数组包裹的子级 这样保证了 最后返回的肯定是一个数组\n    else {\n      return [childVal];\n    }\n  }\n  // 如果没有子级则直接返回父级\n  else {\n    return parentVal;\n  }\n}\n\nLIFECYCLE_HOOKS.forEach((hook) => {\n  strats[hook] = mergeHook;\n});\n// 合并方法 用于全局api mixin\nexport function mergeOptions(parent, child) {\n  const options = {};\n  // 循环父级options\n  for (let key in parent) {\n    // 用户合并父子级的key\n    mergeField(key);\n  }\n  // 循环子级options 这时如果父级中有的key已经在上一个循环中处理过了 需要过滤一下\n  for (let key in child) {\n    // 过滤父级中的key\n    if (!parent.hasOwnProperty(key)) {\n      mergeField(key);\n    }\n  }\n\n  function mergeField(key) {\n    if (strats[key]) {\n      options[key] = strats[key](parent[key], child[key]);\n    }\n    // 如果父级和子级中都有且他们都是对象那么就合并对象  否则就赋值为子级 如果子级没有这个key，那么就还使用父级\n    else if (isObject(parent[key]) && isObject(child[key])) {\n      options[key] = {\n        ...parent[key],\n        ...child[key],\n      };\n    } else {\n      if (child[key] == null) {\n        options[key] = parent[key];\n      } else {\n        options[key] = child[key];\n      }\n    }\n  }\n  return options;\n}\n","let oldArrayMethods = Array.prototype;\n\nexport let arrayMethods = Object.create(oldArrayMethods);\n\nconst methods = [\"push\", \"shift\", \"unshift\", \"sort\", \"reverse\", \"splice\"];\nmethods.forEach((method) => {\n  arrayMethods[method] = function (...args) {\n    // 获取到当前调用方法上的ob\n    const ob = this.__ob__;\n    // 这里的this指向的是调用函数劫持后修改的数组 也就是调用arrMethods[method]的数组\n    const result = oldArrayMethods[method].apply(this, args); // 调用原数组方法方法\n    let inserted;\n    // 如果是给数组中新增数据，我们需要对新增的数据响应数据处理（如果是对象的话）\n    switch (method) {\n      case \"push\":\n      case \"unshift\":\n        // 新增的数据就是当前方法的参数\n        inserted = args;\n        break;\n      case \"splice\": // splice也可以新增\n        inserted = args.slice(2); // 如果有第三个参数 证明是新增，第三个参数就是新增的那一项\n        break;\n      default:\n        break;\n    }\n    // 将新增的数据变为可观测\n    inserted && ob.observeArray(inserted);\n    return result;\n  };\n});\n","let id = 0;\n\nclass Dep {\n  constructor() {\n    this.id = id++; // 用于标记Dep\n    this.subs = [];\n  }\n  depend() {\n    // 1.让dep记住（存）watcher\n    // 2.让watcher记住dep 双向记忆\n    Dep.target.addDep(this); // 这个时候Dep.target就是watcher\n  }\n  // 存watcher\n  addSub(watcher) {\n    this.subs.push(watcher);\n  }\n  // 通知更新方法\n  notify() {\n    // 调用当前属性对应的每一个watcher的update方法\n    this.subs.forEach((watcher) => watcher.update());\n  }\n}\n\n// 用于标记属性 在defineProperty中 如果Dep.target 不是null 证明被赋值了watcher 然后就走依赖收集的流程\nDep.target = null;\nconst stack = [];\n// 赋值target\nexport function pushTarget(watcher) {\n  Dep.target = watcher;\n  // 这个主要是的computed 和 watch 对应的watcher的标记\n  // stack.push(watcher);\n}\n\n// 删除target\nexport function popTarget() {\n  Dep.target = null;\n  // stack.pop();\n  // Dep.target = stack[stack.length - 1];\n}\n\nexport default Dep;\n","import { isObject } from \"../utils\";\nimport { arrayMethods } from \"./array\";\nimport Dep from \"./dep\";\n\nclass Observer {\n  constructor(data) {\n    // 将当前实例挂载到data上 __ob__也可以作为一个响应式的标识\n    Object.defineProperty(data, \"__ob__\", {\n      enumerable: false, // 为了避免死循环，重复的枚举当前实例，使当前属性不可枚举\n      configurable: false, // 同样也不想这个属性被修改所以也不可配置\n      value: this,\n    });\n    // 判断一下是不是数组类型，如果是数组走函数劫持的方法\n    if (Array.isArray(data)) {\n      data.__proto__ = arrayMethods;\n      this.observeArray(data);\n    } else {\n      this.walk(data);\n    }\n  }\n  // [{a:111}] 需要将这种类型的数据也进行响应观测\n  observeArray(data) {\n    for (let key in data) {\n      observe(data[key]);\n    }\n  }\n  walk(data) {\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key]);\n    });\n  }\n}\n// 递归循环data 重写data的每一个属性\nfunction defineReactive(data, key, value) {\n  observe(value);\n  let dep = new Dep();\n  Object.defineProperty(data, key, {\n    get() {\n      // 判断如果当前属性是否需要依赖收集（也就是当前模板中是否有用到这个属性）\n      if (Dep.target) {\n        dep.depend(); // dep去收集当前属性的依赖\n      }\n      return value;\n    },\n    set(newVal) {\n      if (newVal == value) return;\n      observe(newVal); // 监控当前设置的值 因为设置的值也可能是个对象\n      value = newVal;\n      dep.notify();\n    },\n  });\n}\n\nexport function observe(data) {\n  // 如果不是对象就返回\n  if (!isObject(data)) {\n    return;\n  }\n\n  // 防止对象被重复观测\n  if (data.__ob__ instanceof Observer) {\n    return;\n  }\n  return new Observer(data);\n}\n","import { observe } from \"./obsever/index\";\n\nexport function initState(vm) {\n  const opts = vm.$options;\n  if (opts.props) {\n    initProps(vm);\n  }\n  if (opts.methods) {\n    initMethods(vm);\n  }\n  if (opts.data) {\n    initData(vm);\n  }\n}\n\nfunction initProps() {}\n\nfunction initMethods() {}\n\n// 用于将data上的属性直接代理到实例上 这样就可以直接通过this访问\nfunction proxy(target, property, key) {\n  Object.defineProperty(target, key, {\n    get() {\n      return target[property][key];\n    },\n    set(newValue) {\n      target[property][key] = newValue;\n    },\n  });\n}\n\nfunction initData(vm) {\n  console.log(vm.$options.data);\n  // 数据响应式原理\n  let data = vm.$options.data;\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\n  for (let key in data) {\n    proxy(vm, \"_data\", key);\n  }\n  // 响应化data\n  observe(data);\n}\n","// 一堆正则\n//               字母大小写_  -.数字字母大小写 任意多个\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名\n// ?:匹配但不捕获 <aaa:aaa>\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // 匹配标签名\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\n// 捕获到的是属性名和属性值 属性值可以是双引号/单引号/无引号 包裹\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\n\nexport function parserHTML(html) {\n  let root; // 根元素\n  let stack = []; // 用于记录元素的栈\n  let currentParent; // 记录当前元素\n  // 用于创建元素对象\n  function createASTElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      attrs,\n      children: [],\n      parent: null,\n      type: 1, // nodetype 元素是1，文本是3\n    };\n  }\n  /**\n   * desc 用于解析标签结构的一种方式 栈型结构解析\n   * 以 <div id=\"app\" style=\"color: red\"><span>hello world {{msg}}</span></div> 为例\n   * 解析到div 将div放入栈中 [div]\n   * 继续解析，解析到span将span放入栈中 [div,span]\n   * 继续解析，解析到span的结尾标签，则将span出栈，[div]，这时就可以确定，span是div的子元素，div是span的父元素\n   * 同样的道理，如果解析的过程中遇到了未闭合的标签就可以抛出错误\n   *\n   */\n  // 处理开始标签\n  function start(tagName, attrs) {\n    let element = createASTElement(tagName, attrs);\n    // 将第一个元素赋值为根元素\n    if (!root) {\n      root = element;\n    }\n    currentParent = element;\n    stack.push(element);\n  }\n  // 处理结束标签\n  function end(tagName) {\n    // 解析到结尾标签的时候，将当前栈中的最后一个元素出栈\n    let element = stack.pop();\n    // 判断当前出栈元素是否跟当前结尾标签相同，如果不相同则抛出错误\n    if (element.tag !== tagName) {\n      throw new Error(`${element.tag} 标签未闭合`);\n    }\n    // 遇到结尾标签将当前元素出栈，并修改currentParent的指向\n    currentParent = stack[stack.length - 1];\n    if (currentParent) {\n      // 孩子可以有多个，但是爹只能有一个\n      element.parent = currentParent;\n      currentParent.children.push(element);\n    }\n  }\n  // 处理文本\n  function chars(text) {\n    // 将文本中的空格都删掉\n    text = text.replace(/\\s/g, \"\");\n    if (text) {\n      currentParent.children.push({\n        text,\n        type: 3,\n      });\n    }\n  }\n  // 循环解析\n  while (html) {\n    let textEnd = html.indexOf(\"<\");\n    // 如果是开头标签如<span  或者是结束标签如 </span>\n    if (textEnd === 0) {\n      // 匹配开始标签\n      const startTagMatch = parseStartTag();\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n      }\n      // 匹配结束标签\n      const endTagMatch = html.match(endTag);\n      if (endTagMatch) {\n        // 如果匹配到结束标签就截掉结束标签\n        advance(endTagMatch[0].length);\n        end(endTagMatch[1]);\n      }\n    }\n    // 说明前面已经没有了开始标签，可能是这样的情况了 （hello world {{msg}}</span></div>） 这时的textEnd匹配的是</span>中的<\n    let text; // 这时候应该截取这段文本\n    if (textEnd > 0) {\n      text = html.substring(0, textEnd);\n    }\n    // 如果匹配到文本将文本截掉\n    if (text) {\n      advance(text.length);\n      chars(text);\n    }\n  }\n  // 解析前进（截掉已解析的字符串）\n  function advance(n) {\n    html = html.substring(n);\n  }\n  // 转换开始标签\n  function parseStartTag() {\n    // 获取开始标签\n    const start = html.match(startTagOpen);\n    // 如果匹配到了 就将匹配到的开始标签赋值\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      };\n      // 将匹配到的部分删掉\n      advance(start[0].length);\n      let attr, end;\n      // 循环所有的属性 直到开始标签的结束 >\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        // 将匹配到的属性截取\n        advance(attr[0].length);\n        // 将属性push到match对象中\n        match.attrs.push({\n          name: attr[1],\n          // 分别代表双引号、单引号、无引号的情况\n          value: attr[3] || attr[4] || attr[5],\n        });\n      }\n      // 如果匹配到结束了那么删除结束的> 开始标签匹配结束\n      if (end) {\n        advance(end[0].length);\n        return match;\n      }\n    }\n  }\n  return root;\n}\n","// +？非贪婪模式 （尽可能的少取）\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // 匹配双花括号的\n// 将属性拼接成字符串\nfunction genProps(attrs) {\n  let str = \"\";\n  for (let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i];\n    if (attr.name === \"style\") {\n      let obj = {};\n      let styles = attr.value.split(\";\").forEach((item) => {\n        let [key, value] = item.split(\":\");\n        obj[key] = value;\n      });\n      attr.value = obj;\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\n  }\n  return `{${str.slice(0, -1)}}`;\n}\n\n// 编译每一个child\nfunction gen(node) {\n  // 如果当前的节点是元素 那么就递归循环\n  if (node.type === 1) {\n    return generate(node);\n  } else {\n    // 如果是文本的话 需要处理将变量和普通文本区分出来\n    let text = node.text;\n    // 如果没有变量则直接返回\n    if (!defaultTagRE.test(text)) {\n      return `_v(${JSON.stringify(text)})`;\n    } else {\n      let tokens = []; // 用于放截取出来的字符串\n      let lastIndex = (defaultTagRE.lastIndex = 0); // 正则的lastIndex 修正test过后的变化 置为0\n      let match, index;\n      while ((match = defaultTagRE.exec(text))) {\n        index = match.index; // 当前这次匹配的第一个位置\n        // 当前匹配的位置>上次匹配的结尾 说明当前这一次匹配的位置和上次匹配的位置中间有普通文本，将文本push到tokens中\n        if (index > lastIndex) {\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)));\n        }\n        // 将匹配到的变量用_s()包裹起来\n        tokens.push(`_s(${match[1].trim()})`);\n        console.log(lastIndex);\n        // 将lastIndex修改为匹配到的位置结尾处\n        lastIndex = index + match[0].length;\n      }\n      // 都匹配完了 结尾可能还有一部分 如 helloworld {{msg}}  aa 其中的aa也需要push进去\n      tokens.push(JSON.stringify(text.slice(lastIndex)));\n      return `_v(${tokens.join(\"+\")})`;\n    }\n  }\n}\n// 编译children\nfunction genChildren(el) {\n  const children = el.children;\n  if (children) {\n    return children.map((c) => gen(c)).join(\",\");\n  } else {\n    return false;\n  }\n}\nexport function generate(el) {\n  let children = genChildren(el);\n  let code = `_c(\"${el.tag}\",${\n    el.attrs.length ? genProps(el.attrs) : \"undefined\"\n  }${children ? `,${children}` : \"\"})`;\n  return code;\n}\n","import { parserHTML } from \"./parser\";\nimport { generate } from \"./generate\";\n\nexport function compileToFunctions(template) {\n  console.log(template);\n  // 第一步 由模板编译成ast语法树\n  let ast = parserHTML(template);\n  console.log(ast);\n  /**\n   * 第二步将ast语法树解析成render函数\n   * {\n   *   tag：‘div’,\n   *   attrs:[{name: \"id\", value: \"app\"},{name: \"style\", value: \"color: red\"}],\n   *   children:[{\n   *     tag:'span',\n   *     parent: {tag: \"div\", attrs: Array(2), children: Array(1), parent: null, type: 1},\n   *     children:[{type: 3,text: \"helloworld{{msg}}\"}],\n   *     type:1,\n   *     attrs:[]\n   *   }],\n   *   type:1\n   *   parent: null\n   * }\n   * 转化成\n   * render(){\n   *   return _c('div',{style:{color:'red'}},_v('hello'+_s(name)),_c('span',undefined,''))\n   * }\n   */\n  let code = generate(ast);\n  code = `with(this){return ${code}}`;\n  console.log(code);\n\n  let render = new Function(code); // 将字符串转换为函数\n  return render;\n}\n","let has = {}; // 用于判断是否是重复的watcher 避免同时重复修改某一个属性时 多次的更新视图 浪费性能\nlet queue = []; // watcher的队列\n\n// 将watcher存储进队列\nexport function queueWatcher(watcher) {\n  const id = watcher.id;\n  // 重复的watcher不加入队列\n  if (has[id] == null) {\n    has[id] = true;\n    queue.push(watcher);\n    nextTick(flushSchedulerQueue);\n  }\n}\n\nfunction flushSchedulerQueue() {\n  for (let i = 0; i < queue.length; i++) {\n    queue[i].run();\n  }\n  // 清空 保证当再次更新的时候用的是新的watcher\n  has = {};\n  queue = [];\n}\nlet callbacks = []; // 用于收集当前这次更新调用nextTick方法的所有回调函数，其中第一个回调时上面的flushSchedulerQueue代表的是渲染watcher 他总是在第一个，所后续调用的$nextTick是在渲染后执行的\nlet pending = false; // 代表正在更新\n// 异步更新方法\nexport function nextTick(fn) {\n  callbacks.push(fn);\n  if (!pending) {\n    // 异步执行  用 setTimeout模拟一下 实际上涉及到不同浏览器以及不同情况的事件环兼容 包括Promise，setImmediate, MutationObserver等的情况用法\n    setTimeout(() => {\n      flushCallbacksQueue();\n    }, 0);\n    pending = true;\n  }\n}\n\nfunction flushCallbacksQueue() {\n  callbacks.forEach((fn) => fn());\n  pending = false; // 更新完毕 置为false\n}\n","import { pushTarget, popTarget } from \"./dep\";\nimport { queueWatcher } from \"./scheduler\";\nlet id = 0;\nclass Watcher {\n  constructor(vm, exprOrFn, cb, options) {\n    this.vm = vm;\n    this.exprOrFn = exprOrFn;\n    this.cb = cb;\n    this.options = options;\n    this.deps = []; // 用于记住（存）dep\n    this.depIds = new Set(); // 用于去重dep\n    if (typeof exprOrFn === \"function\") {\n      this.getter = exprOrFn;\n    }\n    this.id = id++; // 用于标记watcher 后面去重用\n    // 需要直接调用渲染和更新的方法 并进行对应的依赖收集 所以直接调用get\n    this.get();\n  }\n  get() {\n    // 标记 这个时候Dep.target就不是null了\n    pushTarget(this);\n    // 渲染和更新方法会访问data中的属性，访问的时候就会调用当前属性get方法 通过get方法中判断Dep.target 进行依赖收集 而此时Dep.target不是null\n    this.getter();\n    // 清空Dep.target\n    popTarget(this);\n  }\n  // 收集dep\n  addDep(dep) {\n    // 判断有没有存过当前的这个dep\n    if (!this.depIds.has(dep.id)) {\n      // 存dep\n      this.deps.push(dep);\n      // 存dep的id\n      this.depIds.add(dep.id);\n      // 将当前的这个watcher存到dep中\n      dep.addSub(this);\n    }\n  }\n  // 更新wather列队\n  update() {\n    queueWatcher(this); // 将watcher存储起来\n    // this.get();\n  }\n  // 更新方法\n  run() {\n    this.get();\n  }\n}\n\nexport default Watcher;\n","export function patch(oldVnode, newVnode) {\n  const isRealElem = oldVnode.nodeType;\n  // 判断是否为真实元素 如果是真实元素则可以用新的虚拟节点（newVnode）创建dom元素 然后添加到当前的元素下面 并删除掉当前元素 实现元素的替换 页面的更新\n  if (isRealElem) {\n    const oldElem = oldVnode;\n    // 获取父元素\n    let parenElem = oldElem.parentNode;\n    // 创建新元素并添加属性\n    let el = createElem(newVnode);\n    console.log(el);\n    // 将新元素添加到父元素上 插入到老元素的后面\n    parenElem.insertBefore(el, oldElem.nextSibling);\n    // 删除老元素\n    parenElem.removeChild(oldElem);\n    return el;\n  } else {\n    // dom diff 是进行同层的比较 正常要diff两棵树 自由度是 O(n^3) 但是如果同层比较就是 O(n) 这样就会优化了很多，因为本身前端操作dom很少会有跨层级操作dom的情况\n    console.log(\"diff\");\n    // 两颗树要先比较根节点 在比较子级\n    // 判断新旧vnode的根节点 元素标签是否相同 如果不同证明整颗树的根节点不同 需要替换\n    if (oldVnode.tag !== newVnode.tag) {\n      oldVnode.el.parentNode.replaceChild(createElem(newVnode), oldVnode.el);\n    }\n    // 都是文本的情况 如果是老节点是文本 新节点是元素 则会走上面那个 tag不相等的判断\n    if (!oldVnode.tag) {\n      if (oldVnode.text !== newVnode.text) {\n        oldVnode.el.textContent = newVnode.text;\n      }\n    }\n    // 走到这里就一定是标签 而且标签一致了\n    // 直接复用老节点的el\n    let el = (newVnode.el = oldVnode.el);\n\n    // 更新属性\n    updateProperties(newVnode, oldVnode.data);\n\n    /**\n     * 比对子节点策略\n     * 情况分析\n     * 新老节点都有子节点 那就比较  这里是diff的核心\n     * 老的有子节点 新的没有子节点 直接删除\n     * 老的没有子节点 新的有子节点 直接添加\n     */\n\n    let oldChildren = oldVnode.children || [];\n    let newChildren = newVnode.children || [];\n\n    if (oldChildren.length > 0 && newChildren.length > 0) {\n      // diff\n      updateChildren(el, oldChildren, newChildren);\n    } else if (oldChildren.length > 0) {\n      el.innerHTML = \"\";\n    } else if (newChildren.length > 0) {\n      for (let i = 0; i < newChildren.length; i++) {\n        let child = newChildren[i];\n        el.appendChild(createElem(child)); // 这里可以用先拼成fragment片段然后再一起挂载，但是现代浏览器有自动做这一层优化\n      }\n    }\n\n    return el;\n  }\n}\n\n// 用于判断两个虚拟节点是否一致\nfunction isSameVnode(oldVnode, newVnode) {\n  return oldVnode.key === newVnode.key && oldVnode.tag === newVnode.tag;\n}\n\n// 更新子节点\nfunction updateChildren(parent, oldChildren, newChildren) {\n  // vue 2.0是使用双指针的方式来进行比对的\n  // v-for需要key来标识元素是否发生变化 前后key相同则复用这个元素\n  let oldStartIndex = 0; // 老的开始索引\n  let oldStartVnode = oldChildren[0]; // 老的开始节点\n  let oldEndIndex = oldChildren.length - 1; // 老的结束索引\n  let oldEndVnode = oldChildren[oldEndIndex]; // 老的结束节点\n  // 新元素\n  let newStartIndex = 0; // 新的开始索引\n  let newStartVnode = newChildren[0]; // 新的开始节点\n  let newEndIndex = newChildren.length - 1; // 新的结束索引\n  let newEndVnode = newChildren[newEndIndex]; // 新的结束节点\n  // 比较时采用的是新老节点中最短的 新旧中哪个先循环完 都结束循环，剩下没循环到的要么是新增 要么就是删除的\n  while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n    // 两个虚拟节点是否一致是通过 key + 元素的 tag类型判断的 看方法isSameVnode\n    if (isSameVnode(oldStartVnode, newStartVnode)) {\n      // 标签和key一致 但是元素的属性可能不一致\n      patch(oldStartVnode, newStartVnode); // 递归调用patch方法\n      // 继续比较下一个元素 修改指针 以及索引元素\n      oldStartVnode = oldChildren[++oldStartIndex];\n      newStartVnode = newChildren[++newStartIndex];\n    }\n  }\n  // 如果循环结束后新的开始节点小于新的结束节点 那说明有新增的元素\n  if (newStartIndex <= newEndIndex) {\n    for (let i = newStartIndex; i <= newEndIndex; i++) {\n      parent.appendChild(createElem(newChildren[i]));\n    }\n  }\n}\n\nexport function createElem(vnode) {\n  console.log(vnode);\n  const { tag, children, text, data, key } = vnode;\n  // 如果tag是string的话 那么当前的这个节点则是元素节点 否则为文本节点\n  if (typeof tag == \"string\") {\n    // 创建元素 将虚拟节点和真实节点做一个映射关系 （后面diff时如果元素相同则可以直接复用老元素）\n    vnode.el = document.createElement(tag);\n    updateProperties(vnode);\n    // 递归调用当前函数 添加子节点\n    if (children.length > 0) {\n      children.forEach((child) => {\n        vnode.el.append(createElem(child));\n      });\n    }\n  } else {\n    vnode.el = document.createTextNode(text);\n  }\n  return vnode.el;\n}\n\n// 设置属性\nfunction updateProperties(vnode, oldProps = {}) {\n  const newProps = vnode.data || {};\n  let el = vnode.el;\n  // 获取新旧节点的style属性对象\n  let newStyle = newProps.style || {};\n  let oldStyle = oldProps.style || {};\n\n  // 比较新旧style属性对象，如果老的属性 新的没有 则将新对象中的属性删掉 如果是新增属性的话 后面的循环添加了\n  for (let key in oldStyle) {\n    if (!newStyle[key]) {\n      newStyle[key] = \"\";\n    }\n  }\n\n  // 如果新的节点中删除了某些属性 则在新的节点上把对应的属性删掉\n  for (let key in oldProps) {\n    if (!newProps[key]) {\n      el.removeAttribute(key);\n    }\n  }\n  for (let key in newProps) {\n    // 如果当前属性是style 就循环style对象把style的每一个属性都添加上\n    if (key === \"style\") {\n      for (let styleName in newProps.style) {\n        el.style[styleName] = newProps.style[styleName];\n      }\n    }\n    // event slot ……\n    else {\n      // 元素属性\n      el.setAttribute(key, newProps[key]);\n    }\n  }\n}\n","import Watcher from \"./obsever/watcher\";\nimport { patch } from \"./vdom/patch\";\n\nexport function lifeCycleMixin(Vue) {\n  Vue.prototype._update = function (vnode) {\n    const vm = this;\n    vm.$el = patch(vm.$el, vnode);\n  };\n}\n\nexport function mountComponent(vm, el) {\n  // Vue在渲染过程中会创建一个“渲染watcher”，只用来渲染\n  // watcher就相当于是一个回调，每次数据变化，就会重新执行watcher\n  callHook(vm, \"beforeMount\");\n  const updateComponent = () => {\n    // _render内部会调用 解析后的render方法  => 返回的是vnode（虚拟节点）\n    // _update将虚拟节点转换为dom节点\n    vm._update(vm._render());\n  };\n  // 每次数据变化 就执行updateComponent 方法进行更新操作\n  new Watcher(vm, updateComponent, () => {}, true);\n  callHook(vm, \"mounted\");\n}\n\n// 调用生命周期函数 应用发布订阅模式，\nexport function callHook(vm, hook) {\n  let handlers = vm.$options[hook]; // 这里是一个同一生命周期函数的数组 [fn,fn,fn]\n  if (handlers) {\n    for (let i = 0; i < handlers.length; i++) {\n      // 将每一个生命周期函数调用 并将生命周期函数的this 指向当前实例\n      handlers[i].call(vm);\n    }\n  }\n}\n","import { initState } from \"./state\";\nimport { compileToFunctions } from \"./compiler/index\";\nimport { mountComponent, callHook } from \"./lifecycle\";\nimport { mergeOptions } from \"./utils\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    // 将Vue.mixin所记录的Vue.options与new Vue传入的options合并 为保证每次调用合并的都是当前的实例的构造函数上的options 所以用 vm.constrcutor.options\n    vm.$options = mergeOptions(vm.constructor.options, options);\n    callHook(vm, \"beforeCreate\");\n    initState(vm);\n    callHook(vm, \"created\");\n    // 通过模板渲染\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el);\n    }\n    // 走到这里就是不需要编译模板了 或者已经编译完了\n  };\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    const options = vm.$options;\n    vm.$el = document.querySelector(el);\n    // 如果用户没有传render方法，那么就需要将template转换成render方法\n    if (!options.render) {\n      let template = vm.$options.template;\n      // 如果用户也没有传template，那么就将el作为模板转换成render函数\n      if (!template && vm.$el) {\n        template = vm.$el.outerHTML;\n      }\n      const render = compileToFunctions(template);\n      options.render = render;\n      console.log(options.render);\n    }\n    // 组件的挂在流程\n    mountComponent(vm, vm.$el);\n  };\n}\n","export function createTextVnode(text) {\n  return vnode(undefined, undefined, undefined, undefined, text);\n}\n\nexport function createElement(tag, data = {}, ...children) {\n  // let key = data.key;\n  // if (key) {\n  //   delete data.key;\n  // }\n  return vnode(tag, data, data.key, children);\n}\n\nfunction vnode(tag, data, key, children, text) {\n  return {\n    tag,\n    data,\n    key,\n    children,\n    text,\n  };\n}\n","import { createTextVnode, createElement } from \"./vdom/create-element\";\n\nexport function renderMixin(Vue) {\n  Vue.prototype._v = function (text) {\n    return createTextVnode(text);\n  };\n  // 创建元素虚拟节点\n  Vue.prototype._c = function () {\n    return createElement(...arguments);\n  };\n  // 值\n  Vue.prototype._s = function (val) {\n    return val == null\n      ? \"\"\n      : typeof val === \"object\"\n      ? JSON.stringify(val)\n      : val;\n  };\n  Vue.prototype._render = function () {\n    console.log(\"_render\");\n    const vm = this;\n    const { render } = vm.$options;\n    // 创建文本的虚拟节点\n\n    const vnode = render.call(this);\n    console.log(vnode);\n    return vnode;\n  };\n}\n","import { mergeOptions } from \"../utils\";\nexport function initGlobalAPI(Vue) {\n  Vue.options = {}; // 所有的全局api 用户传递的参数 都会绑定到这个对象中 （用于收集用户调用全局api传递的参数）\n  // 提取公共的方法 逻辑，通过mixin混合到每一个实例中\n  Vue.mixin = function (mixin) {\n    this.options = mergeOptions(this.options, mixin);\n    console.log(this.options);\n  };\n}\n","import { initMixin } from \"./init\";\nimport { renderMixin } from \"./render\";\nimport { lifeCycleMixin } from \"./lifecycle\";\nimport { initGlobalAPI } from \"./global-api/index\";\nimport { nextTick } from \"./obsever/scheduler\";\n\nfunction Vue(options) {\n  this._init(options);\n}\n\ninitMixin(Vue); // 添加原型方法\nrenderMixin(Vue); // 原型上添加_render方法 用于渲染dom\nlifeCycleMixin(Vue); // 生命周期相关\ninitGlobalAPI(Vue); // 给构造函数扩展全局方法\nVue.prototype.$nextTick = nextTick; // 将nextTick 挂载到原型对象上\n\nimport { compileToFunctions } from \"./compiler/index\";\nimport { patch, createElem } from \"./vdom/patch\";\n// 生成两个虚拟节点用于对比\nlet vm1 = new Vue({ data: { name: \"mopecat\" } });\nlet vm2 = new Vue({ data: { name: \"feely\" } });\n\nlet render1 = compileToFunctions(\n  `<div id=\"a\" c=\"a\" style=\"background: red;color: white\">\n    <li key=\"A\">A</li>\n    <li key=\"B\">B</li>\n    <li key=\"C\">C</li>\n    <li key=\"D\">D</li>\n  </div>`\n);\nlet oldVnode = render1.call(vm1);\nlet realElement = createElem(oldVnode);\ndocument.body.appendChild(realElement);\n\nlet render2 = compileToFunctions(\n  `<div id=\"a\" style=\"background: yellow;color: red;border: 1px solid #dddddd;\">\n    <li key=\"A\">A</li>\n    <li key=\"B\">B</li>\n    <li key=\"C\">C</li>\n    <li key=\"D\">D</li>\n    <li key=\"E\">E</li>\n  </div>`\n);\nlet newVnode = render2.call(vm2);\nsetTimeout(() => {\n  patch(oldVnode, newVnode);\n}, 1000);\n\nexport default Vue;\n"],"names":["isObject","obj","strats","LIFECYCLE_HOOKS","mergeHook","parentVal","childVal","concat","forEach","hook","mergeOptions","parent","child","options","key","mergeField","hasOwnProperty","oldArrayMethods","Array","prototype","arrayMethods","Object","create","methods","method","ob","__ob__","args","result","apply","inserted","slice","observeArray","id","Dep","subs","target","addDep","watcher","push","update","pushTarget","popTarget","Observer","data","defineProperty","enumerable","configurable","value","isArray","__proto__","walk","observe","keys","defineReactive","dep","get","depend","set","newVal","notify","initState","vm","opts","$options","props","initData","proxy","property","newValue","console","log","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parserHTML","html","root","stack","currentParent","createASTElement","tagName","attrs","tag","children","type","start","element","end","pop","Error","length","chars","text","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","i","styles","split","item","JSON","stringify","gen","node","generate","test","tokens","lastIndex","index","exec","trim","join","genChildren","el","map","c","code","compileToFunctions","template","ast","render","Function","has","queue","queueWatcher","nextTick","flushSchedulerQueue","run","callbacks","pending","fn","setTimeout","flushCallbacksQueue","Watcher","exprOrFn","cb","deps","depIds","Set","getter","add","addSub","patch","oldVnode","newVnode","isRealElem","nodeType","oldElem","parenElem","parentNode","createElem","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","isSameVnode","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","vnode","document","createElement","append","createTextNode","oldProps","newProps","newStyle","style","oldStyle","removeAttribute","styleName","setAttribute","lifeCycleMixin","Vue","_update","$el","mountComponent","callHook","updateComponent","_render","handlers","initMixin","_init","constructor","$mount","querySelector","outerHTML","createTextVnode","undefined","renderMixin","_v","_c","arguments","_s","val","initGlobalAPI","mixin","$nextTick","vm1","vm2","render1","realElement","body","render2"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACO,SAASA,QAAT,CAAkBC,GAAlB,EAAuB;EAC5B,SAAO,QAAOA,GAAP,MAAe,QAAf,IAA2BA,GAAG,KAAK,IAA1C;EACD;;EAGD,IAAIC,MAAM,GAAG,EAAb;;EAEA,IAAMC,eAAe,GAAG,CACtB,cADsB,EAEtB,SAFsB,EAGtB,aAHsB,EAItB,SAJsB,EAKtB,cALsB,EAMtB,SANsB,CAAxB;EAQA;;;;;;;EAMA,SAASC,SAAT,CAAmBC,SAAnB,EAA8BC,QAA9B,EAAwC;EACtC;EACA,MAAIA,QAAJ,EAAc;EACZ,QAAID,SAAJ,EAAe;EACb,aAAOA,SAAS,CAACE,MAAV,CAAiBD,QAAjB,CAAP;EACD,KAFD;EAAA,SAIK;EACH,eAAO,CAACA,QAAD,CAAP;EACD;EACF,GARD;EAAA,OAUK;EACH,aAAOD,SAAP;EACD;EACF;;EAEDF,eAAe,CAACK,OAAhB,CAAwB,UAACC,IAAD,EAAU;EAChCP,EAAAA,MAAM,CAACO,IAAD,CAAN,GAAeL,SAAf;EACD,CAFD;;EAIO,SAASM,YAAT,CAAsBC,MAAtB,EAA8BC,KAA9B,EAAqC;EAC1C,MAAMC,OAAO,GAAG,EAAhB,CAD0C;;EAG1C,OAAK,IAAIC,GAAT,IAAgBH,MAAhB,EAAwB;EACtB;EACAI,IAAAA,UAAU,CAACD,GAAD,CAAV;EACD,GANyC;;;EAQ1C,OAAK,IAAIA,IAAT,IAAgBF,KAAhB,EAAuB;EACrB;EACA,QAAI,CAACD,MAAM,CAACK,cAAP,CAAsBF,IAAtB,CAAL,EAAiC;EAC/BC,MAAAA,UAAU,CAACD,IAAD,CAAV;EACD;EACF;;EAED,WAASC,UAAT,CAAoBD,GAApB,EAAyB;EACvB,QAAIZ,MAAM,CAACY,GAAD,CAAV,EAAiB;EACfD,MAAAA,OAAO,CAACC,GAAD,CAAP,GAAeZ,MAAM,CAACY,GAAD,CAAN,CAAYH,MAAM,CAACG,GAAD,CAAlB,EAAyBF,KAAK,CAACE,GAAD,CAA9B,CAAf;EACD,KAFD;EAAA,SAIK,IAAId,QAAQ,CAACW,MAAM,CAACG,GAAD,CAAP,CAAR,IAAyBd,QAAQ,CAACY,KAAK,CAACE,GAAD,CAAN,CAArC,EAAmD;EACtDD,QAAAA,OAAO,CAACC,GAAD,CAAP,qCACKH,MAAM,CAACG,GAAD,CADX,GAEKF,KAAK,CAACE,GAAD,CAFV;EAID,OALI,MAKE;EACL,YAAIF,KAAK,CAACE,GAAD,CAAL,IAAc,IAAlB,EAAwB;EACtBD,UAAAA,OAAO,CAACC,GAAD,CAAP,GAAeH,MAAM,CAACG,GAAD,CAArB;EACD,SAFD,MAEO;EACLD,UAAAA,OAAO,CAACC,GAAD,CAAP,GAAeF,KAAK,CAACE,GAAD,CAApB;EACD;EACF;EACF;;EACD,SAAOD,OAAP;EACD;;EC7ED,IAAII,eAAe,GAAGC,KAAK,CAACC,SAA5B;EAEO,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcL,eAAd,CAAnB;EAEP,IAAMM,OAAO,GAAG,CAAC,MAAD,EAAS,OAAT,EAAkB,SAAlB,EAA6B,MAA7B,EAAqC,SAArC,EAAgD,QAAhD,CAAhB;EACAA,OAAO,CAACf,OAAR,CAAgB,UAACgB,MAAD,EAAY;EAC1BJ,EAAAA,YAAY,CAACI,MAAD,CAAZ,GAAuB,YAAmB;EACxC;EACA,QAAMC,EAAE,GAAG,KAAKC,MAAhB,CAFwC;;EAAA,sCAANC,IAAM;EAANA,MAAAA,IAAM;EAAA;;EAIxC,QAAMC,MAAM,GAAGX,eAAe,CAACO,MAAD,CAAf,CAAwBK,KAAxB,CAA8B,IAA9B,EAAoCF,IAApC,CAAf,CAJwC;;EAKxC,QAAIG,QAAJ,CALwC;;EAOxC,YAAQN,MAAR;EACE,WAAK,MAAL;EACA,WAAK,SAAL;EACE;EACAM,QAAAA,QAAQ,GAAGH,IAAX;EACA;;EACF,WAAK,QAAL;EAAe;EACbG,QAAAA,QAAQ,GAAGH,IAAI,CAACI,KAAL,CAAW,CAAX,CAAX,CADF;;EAEE;EARJ,KAPwC;;;EAoBxCD,IAAAA,QAAQ,IAAIL,EAAE,CAACO,YAAH,CAAgBF,QAAhB,CAAZ;EACA,WAAOF,MAAP;EACD,GAtBD;EAuBD,CAxBD;;ECLA,IAAIK,EAAE,GAAG,CAAT;;MAEMC;EACJ,iBAAc;EAAA;;EACZ,SAAKD,EAAL,GAAUA,EAAE,EAAZ,CADY;;EAEZ,SAAKE,IAAL,GAAY,EAAZ;EACD;;;;+BACQ;EACP;EACA;EACAD,MAAAA,GAAG,CAACE,MAAJ,CAAWC,MAAX,CAAkB,IAAlB,EAHO;EAIR;;;;6BAEMC,SAAS;EACd,WAAKH,IAAL,CAAUI,IAAV,CAAeD,OAAf;EACD;;;;+BAEQ;EACP;EACA,WAAKH,IAAL,CAAU3B,OAAV,CAAkB,UAAC8B,OAAD;EAAA,eAAaA,OAAO,CAACE,MAAR,EAAb;EAAA,OAAlB;EACD;;;;;;;EAIHN,GAAG,CAACE,MAAJ,GAAa,IAAb;;EAGO,SAASK,UAAT,CAAoBH,OAApB,EAA6B;EAClCJ,EAAAA,GAAG,CAACE,MAAJ,GAAaE,OAAb,CADkC;EAGlC;EACD;;EAGM,SAASI,SAAT,GAAqB;EAC1BR,EAAAA,GAAG,CAACE,MAAJ,GAAa,IAAb,CAD0B;EAG1B;EACD;;MClCKO;EACJ,oBAAYC,IAAZ,EAAkB;EAAA;;EAChB;EACAvB,IAAAA,MAAM,CAACwB,cAAP,CAAsBD,IAAtB,EAA4B,QAA5B,EAAsC;EACpCE,MAAAA,UAAU,EAAE,KADwB;EACjB;EACnBC,MAAAA,YAAY,EAAE,KAFsB;EAEf;EACrBC,MAAAA,KAAK,EAAE;EAH6B,KAAtC,EAFgB;;EAQhB,QAAI9B,KAAK,CAAC+B,OAAN,CAAcL,IAAd,CAAJ,EAAyB;EACvBA,MAAAA,IAAI,CAACM,SAAL,GAAiB9B,YAAjB;EACA,WAAKY,YAAL,CAAkBY,IAAlB;EACD,KAHD,MAGO;EACL,WAAKO,IAAL,CAAUP,IAAV;EACD;EACF;;;;;mCAEYA,MAAM;EACjB,WAAK,IAAI9B,GAAT,IAAgB8B,IAAhB,EAAsB;EACpBQ,QAAAA,OAAO,CAACR,IAAI,CAAC9B,GAAD,CAAL,CAAP;EACD;EACF;;;2BACI8B,MAAM;EACTvB,MAAAA,MAAM,CAACgC,IAAP,CAAYT,IAAZ,EAAkBpC,OAAlB,CAA0B,UAACM,GAAD,EAAS;EACjCwC,QAAAA,cAAc,CAACV,IAAD,EAAO9B,GAAP,EAAY8B,IAAI,CAAC9B,GAAD,CAAhB,CAAd;EACD,OAFD;EAGD;;;;;;;EAGH,SAASwC,cAAT,CAAwBV,IAAxB,EAA8B9B,GAA9B,EAAmCkC,KAAnC,EAA0C;EACxCI,EAAAA,OAAO,CAACJ,KAAD,CAAP;EACA,MAAIO,GAAG,GAAG,IAAIrB,GAAJ,EAAV;EACAb,EAAAA,MAAM,CAACwB,cAAP,CAAsBD,IAAtB,EAA4B9B,GAA5B,EAAiC;EAC/B0C,IAAAA,GAD+B,iBACzB;EACJ;EACA,UAAItB,GAAG,CAACE,MAAR,EAAgB;EACdmB,QAAAA,GAAG,CAACE,MAAJ,GADc;EAEf;;EACD,aAAOT,KAAP;EACD,KAP8B;EAQ/BU,IAAAA,GAR+B,eAQ3BC,MAR2B,EAQnB;EACV,UAAIA,MAAM,IAAIX,KAAd,EAAqB;EACrBI,MAAAA,OAAO,CAACO,MAAD,CAAP,CAFU;;EAGVX,MAAAA,KAAK,GAAGW,MAAR;EACAJ,MAAAA,GAAG,CAACK,MAAJ;EACD;EAb8B,GAAjC;EAeD;;EAEM,SAASR,OAAT,CAAiBR,IAAjB,EAAuB;EAC5B;EACA,MAAI,CAAC5C,QAAQ,CAAC4C,IAAD,CAAb,EAAqB;EACnB;EACD,GAJ2B;;;EAO5B,MAAIA,IAAI,CAAClB,MAAL,YAAuBiB,QAA3B,EAAqC;EACnC;EACD;;EACD,SAAO,IAAIA,QAAJ,CAAaC,IAAb,CAAP;EACD;;EC9DM,SAASiB,SAAT,CAAmBC,EAAnB,EAAuB;EAC5B,MAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;EACA,MAAID,IAAI,CAACE,KAAT,EAAgB;;EAGhB,MAAIF,IAAI,CAACxC,OAAT,EAAkB;;EAGlB,MAAIwC,IAAI,CAACnB,IAAT,EAAe;EACbsB,IAAAA,QAAQ,CAACJ,EAAD,CAAR;EACD;EACF;;;EAOD,SAASK,KAAT,CAAe/B,MAAf,EAAuBgC,QAAvB,EAAiCtD,GAAjC,EAAsC;EACpCO,EAAAA,MAAM,CAACwB,cAAP,CAAsBT,MAAtB,EAA8BtB,GAA9B,EAAmC;EACjC0C,IAAAA,GADiC,iBAC3B;EACJ,aAAOpB,MAAM,CAACgC,QAAD,CAAN,CAAiBtD,GAAjB,CAAP;EACD,KAHgC;EAIjC4C,IAAAA,GAJiC,eAI7BW,QAJ6B,EAInB;EACZjC,MAAAA,MAAM,CAACgC,QAAD,CAAN,CAAiBtD,GAAjB,IAAwBuD,QAAxB;EACD;EANgC,GAAnC;EAQD;;EAED,SAASH,QAAT,CAAkBJ,EAAlB,EAAsB;EACpBQ,EAAAA,OAAO,CAACC,GAAR,CAAYT,EAAE,CAACE,QAAH,CAAYpB,IAAxB,EADoB;;EAGpB,MAAIA,IAAI,GAAGkB,EAAE,CAACE,QAAH,CAAYpB,IAAvB;EACAA,EAAAA,IAAI,GAAGkB,EAAE,CAACU,KAAH,GAAW,OAAO5B,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAAC6B,IAAL,CAAUX,EAAV,CAA7B,GAA6ClB,IAA/D;;EACA,OAAK,IAAI9B,GAAT,IAAgB8B,IAAhB,EAAsB;EACpBuB,IAAAA,KAAK,CAACL,EAAD,EAAK,OAAL,EAAchD,GAAd,CAAL;EACD,GAPmB;;;EASpBsC,EAAAA,OAAO,CAACR,IAAD,CAAP;EACD;;ECzCD;EACA;EACA,IAAM8B,MAAM,iCAAZ;EACA;;EACA,IAAMC,YAAY,iBAAUD,MAAV,kBAAwBA,MAAxB,MAAlB;;EACA,IAAME,YAAY,GAAG,IAAIC,MAAJ,aAAgBF,YAAhB,EAArB;;EACA,IAAMG,MAAM,GAAG,IAAID,MAAJ,gBAAmBF,YAAnB,YAAf;EACA;;EACA,IAAMI,SAAS,GAAG,2EAAlB;;EACA,IAAMC,aAAa,GAAG,YAAtB;;EAEO,SAASC,UAAT,CAAoBC,IAApB,EAA0B;EAC/B,MAAIC,IAAJ,CAD+B;;EAE/B,MAAIC,KAAK,GAAG,EAAZ,CAF+B;;EAG/B,MAAIC,aAAJ,CAH+B;EAI/B;;EACA,WAASC,gBAAT,CAA0BC,OAA1B,EAAmCC,KAAnC,EAA0C;EACxC,WAAO;EACLC,MAAAA,GAAG,EAAEF,OADA;EAELC,MAAAA,KAAK,EAALA,KAFK;EAGLE,MAAAA,QAAQ,EAAE,EAHL;EAIL/E,MAAAA,MAAM,EAAE,IAJH;EAKLgF,MAAAA,IAAI,EAAE,CALD;;EAAA,KAAP;EAOD;EACD;;;;;;;;;EASA;;;EACA,WAASC,KAAT,CAAeL,OAAf,EAAwBC,KAAxB,EAA+B;EAC7B,QAAIK,OAAO,GAAGP,gBAAgB,CAACC,OAAD,EAAUC,KAAV,CAA9B,CAD6B;;EAG7B,QAAI,CAACL,IAAL,EAAW;EACTA,MAAAA,IAAI,GAAGU,OAAP;EACD;;EACDR,IAAAA,aAAa,GAAGQ,OAAhB;EACAT,IAAAA,KAAK,CAAC7C,IAAN,CAAWsD,OAAX;EACD,GAhC8B;;;EAkC/B,WAASC,GAAT,CAAaP,OAAb,EAAsB;EACpB;EACA,QAAIM,OAAO,GAAGT,KAAK,CAACW,GAAN,EAAd,CAFoB;;EAIpB,QAAIF,OAAO,CAACJ,GAAR,KAAgBF,OAApB,EAA6B;EAC3B,YAAM,IAAIS,KAAJ,WAAaH,OAAO,CAACJ,GAArB,qCAAN;EACD,KANmB;;;EAQpBJ,IAAAA,aAAa,GAAGD,KAAK,CAACA,KAAK,CAACa,MAAN,GAAe,CAAhB,CAArB;;EACA,QAAIZ,aAAJ,EAAmB;EACjB;EACAQ,MAAAA,OAAO,CAAClF,MAAR,GAAiB0E,aAAjB;EACAA,MAAAA,aAAa,CAACK,QAAd,CAAuBnD,IAAvB,CAA4BsD,OAA5B;EACD;EACF,GAhD8B;;;EAkD/B,WAASK,KAAT,CAAeC,IAAf,EAAqB;EACnB;EACAA,IAAAA,IAAI,GAAGA,IAAI,CAACC,OAAL,CAAa,KAAb,EAAoB,EAApB,CAAP;;EACA,QAAID,IAAJ,EAAU;EACRd,MAAAA,aAAa,CAACK,QAAd,CAAuBnD,IAAvB,CAA4B;EAC1B4D,QAAAA,IAAI,EAAJA,IAD0B;EAE1BR,QAAAA,IAAI,EAAE;EAFoB,OAA5B;EAID;EACF,GA3D8B;;;EA6D/B,SAAOT,IAAP,EAAa;EACX,QAAImB,OAAO,GAAGnB,IAAI,CAACoB,OAAL,CAAa,GAAb,CAAd,CADW;;EAGX,QAAID,OAAO,KAAK,CAAhB,EAAmB;EACjB;EACA,UAAME,aAAa,GAAGC,aAAa,EAAnC;;EACA,UAAID,aAAJ,EAAmB;EACjBX,QAAAA,KAAK,CAACW,aAAa,CAAChB,OAAf,EAAwBgB,aAAa,CAACf,KAAtC,CAAL;EACD,OALgB;;;EAOjB,UAAMiB,WAAW,GAAGvB,IAAI,CAACwB,KAAL,CAAW5B,MAAX,CAApB;;EACA,UAAI2B,WAAJ,EAAiB;EACf;EACAE,QAAAA,OAAO,CAACF,WAAW,CAAC,CAAD,CAAX,CAAeR,MAAhB,CAAP;EACAH,QAAAA,GAAG,CAACW,WAAW,CAAC,CAAD,CAAZ,CAAH;EACD;EACF,KAhBU;;;EAkBX,QAAIN,IAAI,SAAR,CAlBW;;EAmBX,QAAIE,OAAO,GAAG,CAAd,EAAiB;EACfF,MAAAA,IAAI,GAAGjB,IAAI,CAAC0B,SAAL,CAAe,CAAf,EAAkBP,OAAlB,CAAP;EACD,KArBU;;;EAuBX,QAAIF,IAAJ,EAAU;EACRQ,MAAAA,OAAO,CAACR,IAAI,CAACF,MAAN,CAAP;EACAC,MAAAA,KAAK,CAACC,IAAD,CAAL;EACD;EACF,GAxF8B;;;EA0F/B,WAASQ,OAAT,CAAiBE,CAAjB,EAAoB;EAClB3B,IAAAA,IAAI,GAAGA,IAAI,CAAC0B,SAAL,CAAeC,CAAf,CAAP;EACD,GA5F8B;;;EA8F/B,WAASL,aAAT,GAAyB;EACvB;EACA,QAAMZ,KAAK,GAAGV,IAAI,CAACwB,KAAL,CAAW9B,YAAX,CAAd,CAFuB;;EAIvB,QAAIgB,KAAJ,EAAW;EACT,UAAMc,KAAK,GAAG;EACZnB,QAAAA,OAAO,EAAEK,KAAK,CAAC,CAAD,CADF;EAEZJ,QAAAA,KAAK,EAAE;EAFK,OAAd,CADS;;EAMTmB,MAAAA,OAAO,CAACf,KAAK,CAAC,CAAD,CAAL,CAASK,MAAV,CAAP;;EACA,UAAIa,IAAJ,EAAUhB,IAAV,CAPS;;;EAST,aACE,EAAEA,IAAG,GAAGZ,IAAI,CAACwB,KAAL,CAAW1B,aAAX,CAAR,MACC8B,IAAI,GAAG5B,IAAI,CAACwB,KAAL,CAAW3B,SAAX,CADR,CADF,EAGE;EACA;EACA4B,QAAAA,OAAO,CAACG,IAAI,CAAC,CAAD,CAAJ,CAAQb,MAAT,CAAP,CAFA;;EAIAS,QAAAA,KAAK,CAAClB,KAAN,CAAYjD,IAAZ,CAAiB;EACfwE,UAAAA,IAAI,EAAED,IAAI,CAAC,CAAD,CADK;EAEf;EACA9D,UAAAA,KAAK,EAAE8D,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAf,IAAsBA,IAAI,CAAC,CAAD;EAHlB,SAAjB;EAKD,OArBQ;;;EAuBT,UAAIhB,IAAJ,EAAS;EACPa,QAAAA,OAAO,CAACb,IAAG,CAAC,CAAD,CAAH,CAAOG,MAAR,CAAP;EACA,eAAOS,KAAP;EACD;EACF;EACF;;EACD,SAAOvB,IAAP;EACD;;EC3ID;EACA,IAAM6B,YAAY,GAAG,0BAArB;EACA;;EACA,SAASC,QAAT,CAAkBzB,KAAlB,EAAyB;EACvB,MAAI0B,GAAG,GAAG,EAAV;;EACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG3B,KAAK,CAACS,MAA1B,EAAkCkB,CAAC,EAAnC,EAAuC;EACrC,QAAIL,IAAI,GAAGtB,KAAK,CAAC2B,CAAD,CAAhB;;EACA,QAAIL,IAAI,CAACC,IAAL,KAAc,OAAlB,EAA2B;EAAA;EACzB,YAAI9G,GAAG,GAAG,EAAV;EACA,YAAImH,MAAM,GAAGN,IAAI,CAAC9D,KAAL,CAAWqE,KAAX,CAAiB,GAAjB,EAAsB7G,OAAtB,CAA8B,UAAC8G,IAAD,EAAU;EAAA,4BAChCA,IAAI,CAACD,KAAL,CAAW,GAAX,CADgC;EAAA;EAAA,cAC9CvG,GAD8C;EAAA,cACzCkC,KADyC;;EAEnD/C,UAAAA,GAAG,CAACa,GAAD,CAAH,GAAWkC,KAAX;EACD,SAHY,CAAb;EAIA8D,QAAAA,IAAI,CAAC9D,KAAL,GAAa/C,GAAb;EANyB;EAO1B;;EACDiH,IAAAA,GAAG,cAAOJ,IAAI,CAACC,IAAZ,cAAoBQ,IAAI,CAACC,SAAL,CAAeV,IAAI,CAAC9D,KAApB,CAApB,MAAH;EACD;;EACD,oBAAWkE,GAAG,CAACnF,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAX;EACD;;;EAGD,SAAS0F,GAAT,CAAaC,IAAb,EAAmB;EACjB;EACA,MAAIA,IAAI,CAAC/B,IAAL,KAAc,CAAlB,EAAqB;EACnB,WAAOgC,QAAQ,CAACD,IAAD,CAAf;EACD,GAFD,MAEO;EACL;EACA,QAAIvB,IAAI,GAAGuB,IAAI,CAACvB,IAAhB,CAFK;;EAIL,QAAI,CAACa,YAAY,CAACY,IAAb,CAAkBzB,IAAlB,CAAL,EAA8B;EAC5B,0BAAaoB,IAAI,CAACC,SAAL,CAAerB,IAAf,CAAb;EACD,KAFD,MAEO;EACL,UAAI0B,MAAM,GAAG,EAAb,CADK;;EAEL,UAAIC,SAAS,GAAId,YAAY,CAACc,SAAb,GAAyB,CAA1C,CAFK;;EAGL,UAAIpB,KAAJ,EAAWqB,KAAX;;EACA,aAAQrB,KAAK,GAAGM,YAAY,CAACgB,IAAb,CAAkB7B,IAAlB,CAAhB,EAA0C;EACxC4B,QAAAA,KAAK,GAAGrB,KAAK,CAACqB,KAAd,CADwC;EAExC;;EACA,YAAIA,KAAK,GAAGD,SAAZ,EAAuB;EACrBD,UAAAA,MAAM,CAACtF,IAAP,CAAYgF,IAAI,CAACC,SAAL,CAAerB,IAAI,CAACpE,KAAL,CAAW+F,SAAX,EAAsBC,KAAtB,CAAf,CAAZ;EACD,SALuC;;;EAOxCF,QAAAA,MAAM,CAACtF,IAAP,cAAkBmE,KAAK,CAAC,CAAD,CAAL,CAASuB,IAAT,EAAlB;EACA3D,QAAAA,OAAO,CAACC,GAAR,CAAYuD,SAAZ,EARwC;;EAUxCA,QAAAA,SAAS,GAAGC,KAAK,GAAGrB,KAAK,CAAC,CAAD,CAAL,CAAST,MAA7B;EACD,OAfI;;;EAiBL4B,MAAAA,MAAM,CAACtF,IAAP,CAAYgF,IAAI,CAACC,SAAL,CAAerB,IAAI,CAACpE,KAAL,CAAW+F,SAAX,CAAf,CAAZ;EACA,0BAAaD,MAAM,CAACK,IAAP,CAAY,GAAZ,CAAb;EACD;EACF;EACF;;;EAED,SAASC,WAAT,CAAqBC,EAArB,EAAyB;EACvB,MAAM1C,QAAQ,GAAG0C,EAAE,CAAC1C,QAApB;;EACA,MAAIA,QAAJ,EAAc;EACZ,WAAOA,QAAQ,CAAC2C,GAAT,CAAa,UAACC,CAAD;EAAA,aAAOb,GAAG,CAACa,CAAD,CAAV;EAAA,KAAb,EAA4BJ,IAA5B,CAAiC,GAAjC,CAAP;EACD,GAFD,MAEO;EACL,WAAO,KAAP;EACD;EACF;;EACM,SAASP,QAAT,CAAkBS,EAAlB,EAAsB;EAC3B,MAAI1C,QAAQ,GAAGyC,WAAW,CAACC,EAAD,CAA1B;EACA,MAAIG,IAAI,kBAAUH,EAAE,CAAC3C,GAAb,gBACN2C,EAAE,CAAC5C,KAAH,CAASS,MAAT,GAAkBgB,QAAQ,CAACmB,EAAE,CAAC5C,KAAJ,CAA1B,GAAuC,WADjC,SAELE,QAAQ,cAAOA,QAAP,IAAoB,EAFvB,MAAR;EAGA,SAAO6C,IAAP;EACD;;ECjEM,SAASC,kBAAT,CAA4BC,QAA5B,EAAsC;EAC3CnE,EAAAA,OAAO,CAACC,GAAR,CAAYkE,QAAZ,EAD2C;;EAG3C,MAAIC,GAAG,GAAGzD,UAAU,CAACwD,QAAD,CAApB;EACAnE,EAAAA,OAAO,CAACC,GAAR,CAAYmE,GAAZ;EACA;;;;;;;;;;;;;;;;;;;;;EAoBA,MAAIH,IAAI,GAAGZ,QAAQ,CAACe,GAAD,CAAnB;EACAH,EAAAA,IAAI,+BAAwBA,IAAxB,MAAJ;EACAjE,EAAAA,OAAO,CAACC,GAAR,CAAYgE,IAAZ;EAEA,MAAII,MAAM,GAAG,IAAIC,QAAJ,CAAaL,IAAb,CAAb,CA7B2C;;EA8B3C,SAAOI,MAAP;EACD;;EClCD,IAAIE,GAAG,GAAG,EAAV;;EACA,IAAIC,KAAK,GAAG,EAAZ;EAEA;;EACO,SAASC,YAAT,CAAsBzG,OAAtB,EAA+B;EACpC,MAAML,EAAE,GAAGK,OAAO,CAACL,EAAnB,CADoC;;EAGpC,MAAI4G,GAAG,CAAC5G,EAAD,CAAH,IAAW,IAAf,EAAqB;EACnB4G,IAAAA,GAAG,CAAC5G,EAAD,CAAH,GAAU,IAAV;EACA6G,IAAAA,KAAK,CAACvG,IAAN,CAAWD,OAAX;EACA0G,IAAAA,QAAQ,CAACC,mBAAD,CAAR;EACD;EACF;;EAED,SAASA,mBAAT,GAA+B;EAC7B,OAAK,IAAI9B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2B,KAAK,CAAC7C,MAA1B,EAAkCkB,CAAC,EAAnC,EAAuC;EACrC2B,IAAAA,KAAK,CAAC3B,CAAD,CAAL,CAAS+B,GAAT;EACD,GAH4B;;;EAK7BL,EAAAA,GAAG,GAAG,EAAN;EACAC,EAAAA,KAAK,GAAG,EAAR;EACD;;EACD,IAAIK,SAAS,GAAG,EAAhB;;EACA,IAAIC,OAAO,GAAG,KAAd;EACA;;EACO,SAASJ,QAAT,CAAkBK,EAAlB,EAAsB;EAC3BF,EAAAA,SAAS,CAAC5G,IAAV,CAAe8G,EAAf;;EACA,MAAI,CAACD,OAAL,EAAc;EACZ;EACAE,IAAAA,UAAU,CAAC,YAAM;EACfC,MAAAA,mBAAmB;EACpB,KAFS,EAEP,CAFO,CAAV;EAGAH,IAAAA,OAAO,GAAG,IAAV;EACD;EACF;;EAED,SAASG,mBAAT,GAA+B;EAC7BJ,EAAAA,SAAS,CAAC3I,OAAV,CAAkB,UAAC6I,EAAD;EAAA,WAAQA,EAAE,EAAV;EAAA,GAAlB;EACAD,EAAAA,OAAO,GAAG,KAAV,CAF6B;EAG9B;;ECrCD,IAAInH,IAAE,GAAG,CAAT;;MACMuH;EACJ,mBAAY1F,EAAZ,EAAgB2F,QAAhB,EAA0BC,EAA1B,EAA8B7I,OAA9B,EAAuC;EAAA;;EACrC,SAAKiD,EAAL,GAAUA,EAAV;EACA,SAAK2F,QAAL,GAAgBA,QAAhB;EACA,SAAKC,EAAL,GAAUA,EAAV;EACA,SAAK7I,OAAL,GAAeA,OAAf;EACA,SAAK8I,IAAL,GAAY,EAAZ,CALqC;;EAMrC,SAAKC,MAAL,GAAc,IAAIC,GAAJ,EAAd,CANqC;;EAOrC,QAAI,OAAOJ,QAAP,KAAoB,UAAxB,EAAoC;EAClC,WAAKK,MAAL,GAAcL,QAAd;EACD;;EACD,SAAKxH,EAAL,GAAUA,IAAE,EAAZ,CAVqC;EAWrC;;EACA,SAAKuB,GAAL;EACD;;;;4BACK;EACJ;EACAf,MAAAA,UAAU,CAAC,IAAD,CAAV,CAFI;;EAIJ,WAAKqH,MAAL,GAJI;;EAMJpH,MAAAA,SAAS,CAAA,CAAT;EACD;;;;6BAEMa,KAAK;EACV;EACA,UAAI,CAAC,KAAKqG,MAAL,CAAYf,GAAZ,CAAgBtF,GAAG,CAACtB,EAApB,CAAL,EAA8B;EAC5B;EACA,aAAK0H,IAAL,CAAUpH,IAAV,CAAegB,GAAf,EAF4B;;EAI5B,aAAKqG,MAAL,CAAYG,GAAZ,CAAgBxG,GAAG,CAACtB,EAApB,EAJ4B;;EAM5BsB,QAAAA,GAAG,CAACyG,MAAJ,CAAW,IAAX;EACD;EACF;;;;+BAEQ;EACPjB,MAAAA,YAAY,CAAC,IAAD,CAAZ,CADO;EAEP;EACD;;;;4BAEK;EACJ,WAAKvF,GAAL;EACD;;;;;;EC9CI,SAASyG,KAAT,CAAeC,QAAf,EAAyBC,QAAzB,EAAmC;EACxC,MAAMC,UAAU,GAAGF,QAAQ,CAACG,QAA5B,CADwC;;EAGxC,MAAID,UAAJ,EAAgB;EACd,QAAME,OAAO,GAAGJ,QAAhB,CADc;;EAGd,QAAIK,SAAS,GAAGD,OAAO,CAACE,UAAxB,CAHc;;EAKd,QAAIpC,EAAE,GAAGqC,UAAU,CAACN,QAAD,CAAnB;EACA7F,IAAAA,OAAO,CAACC,GAAR,CAAY6D,EAAZ,EANc;;EAQdmC,IAAAA,SAAS,CAACG,YAAV,CAAuBtC,EAAvB,EAA2BkC,OAAO,CAACK,WAAnC,EARc;;EAUdJ,IAAAA,SAAS,CAACK,WAAV,CAAsBN,OAAtB;EACA,WAAOlC,EAAP;EACD,GAZD,MAYO;EACL;EACA9D,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAFK;EAIL;;EACA,QAAI2F,QAAQ,CAACzE,GAAT,KAAiB0E,QAAQ,CAAC1E,GAA9B,EAAmC;EACjCyE,MAAAA,QAAQ,CAAC9B,EAAT,CAAYoC,UAAZ,CAAuBK,YAAvB,CAAoCJ,UAAU,CAACN,QAAD,CAA9C,EAA0DD,QAAQ,CAAC9B,EAAnE;EACD,KAPI;;;EASL,QAAI,CAAC8B,QAAQ,CAACzE,GAAd,EAAmB;EACjB,UAAIyE,QAAQ,CAAC/D,IAAT,KAAkBgE,QAAQ,CAAChE,IAA/B,EAAqC;EACnC+D,QAAAA,QAAQ,CAAC9B,EAAT,CAAY0C,WAAZ,GAA0BX,QAAQ,CAAChE,IAAnC;EACD;EACF,KAbI;EAeL;;;EACA,QAAIiC,GAAE,GAAI+B,QAAQ,CAAC/B,EAAT,GAAc8B,QAAQ,CAAC9B,EAAjC,CAhBK;;;EAmBL2C,IAAAA,gBAAgB,CAACZ,QAAD,EAAWD,QAAQ,CAACtH,IAApB,CAAhB;EAEA;;;;;;;;EAQA,QAAIoI,WAAW,GAAGd,QAAQ,CAACxE,QAAT,IAAqB,EAAvC;EACA,QAAIuF,WAAW,GAAGd,QAAQ,CAACzE,QAAT,IAAqB,EAAvC;;EAEA,QAAIsF,WAAW,CAAC/E,MAAZ,GAAqB,CAArB,IAA0BgF,WAAW,CAAChF,MAAZ,GAAqB,CAAnD,EAAsD;EACpD;EACAiF,MAAAA,cAAc,CAAC9C,GAAD,EAAK4C,WAAL,EAAkBC,WAAlB,CAAd;EACD,KAHD,MAGO,IAAID,WAAW,CAAC/E,MAAZ,GAAqB,CAAzB,EAA4B;EACjCmC,MAAAA,GAAE,CAAC+C,SAAH,GAAe,EAAf;EACD,KAFM,MAEA,IAAIF,WAAW,CAAChF,MAAZ,GAAqB,CAAzB,EAA4B;EACjC,WAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8D,WAAW,CAAChF,MAAhC,EAAwCkB,CAAC,EAAzC,EAA6C;EAC3C,YAAIvG,KAAK,GAAGqK,WAAW,CAAC9D,CAAD,CAAvB;;EACAiB,QAAAA,GAAE,CAACgD,WAAH,CAAeX,UAAU,CAAC7J,KAAD,CAAzB,EAF2C;;EAG5C;EACF;;EAED,WAAOwH,GAAP;EACD;EACF;;EAGD,SAASiD,WAAT,CAAqBnB,QAArB,EAA+BC,QAA/B,EAAyC;EACvC,SAAOD,QAAQ,CAACpJ,GAAT,KAAiBqJ,QAAQ,CAACrJ,GAA1B,IAAiCoJ,QAAQ,CAACzE,GAAT,KAAiB0E,QAAQ,CAAC1E,GAAlE;EACD;;;EAGD,SAASyF,cAAT,CAAwBvK,MAAxB,EAAgCqK,WAAhC,EAA6CC,WAA7C,EAA0D;EACxD;EACA;EACA,MAAIK,aAAa,GAAG,CAApB,CAHwD;;EAIxD,MAAIC,aAAa,GAAGP,WAAW,CAAC,CAAD,CAA/B,CAJwD;;EAKxD,MAAIQ,WAAW,GAAGR,WAAW,CAAC/E,MAAZ,GAAqB,CAAvC,CALwD;;EAMxD,MAAIwF,WAAW,GAAGT,WAAW,CAACQ,WAAD,CAA7B,CANwD;EAOxD;;EACA,MAAIE,aAAa,GAAG,CAApB,CARwD;;EASxD,MAAIC,aAAa,GAAGV,WAAW,CAAC,CAAD,CAA/B,CATwD;;EAUxD,MAAIW,WAAW,GAAGX,WAAW,CAAChF,MAAZ,GAAqB,CAAvC,CAVwD;;EAWxD,MAAI4F,WAAW,GAAGZ,WAAW,CAACW,WAAD,CAA7B,CAXwD;EAYxD;;EACA,SAAON,aAAa,IAAIE,WAAjB,IAAgCE,aAAa,IAAIE,WAAxD,EAAqE;EACnE;EACA,QAAIP,WAAW,CAACE,aAAD,EAAgBI,aAAhB,CAAf,EAA+C;EAC7C;EACA1B,MAAAA,KAAK,CAACsB,aAAD,EAAgBI,aAAhB,CAAL,CAF6C;EAG7C;;EACAJ,MAAAA,aAAa,GAAGP,WAAW,CAAC,EAAEM,aAAH,CAA3B;EACAK,MAAAA,aAAa,GAAGV,WAAW,CAAC,EAAES,aAAH,CAA3B;EACD;EACF,GAtBuD;;;EAwBxD,MAAIA,aAAa,IAAIE,WAArB,EAAkC;EAChC,SAAK,IAAIzE,CAAC,GAAGuE,aAAb,EAA4BvE,CAAC,IAAIyE,WAAjC,EAA8CzE,CAAC,EAA/C,EAAmD;EACjDxG,MAAAA,MAAM,CAACyK,WAAP,CAAmBX,UAAU,CAACQ,WAAW,CAAC9D,CAAD,CAAZ,CAA7B;EACD;EACF;EACF;;EAEM,SAASsD,UAAT,CAAoBqB,KAApB,EAA2B;EAChCxH,EAAAA,OAAO,CAACC,GAAR,CAAYuH,KAAZ;EADgC,MAExBrG,GAFwB,GAEWqG,KAFX,CAExBrG,GAFwB;EAAA,MAEnBC,QAFmB,GAEWoG,KAFX,CAEnBpG,QAFmB;EAAA,MAETS,IAFS,GAEW2F,KAFX,CAET3F,IAFS;EAAA,MAEHvD,IAFG,GAEWkJ,KAFX,CAEHlJ,IAFG;EAAA,MAEG9B,GAFH,GAEWgL,KAFX,CAEGhL,GAFH;;EAIhC,MAAI,OAAO2E,GAAP,IAAc,QAAlB,EAA4B;EAC1B;EACAqG,IAAAA,KAAK,CAAC1D,EAAN,GAAW2D,QAAQ,CAACC,aAAT,CAAuBvG,GAAvB,CAAX;EACAsF,IAAAA,gBAAgB,CAACe,KAAD,CAAhB,CAH0B;;EAK1B,QAAIpG,QAAQ,CAACO,MAAT,GAAkB,CAAtB,EAAyB;EACvBP,MAAAA,QAAQ,CAAClF,OAAT,CAAiB,UAACI,KAAD,EAAW;EAC1BkL,QAAAA,KAAK,CAAC1D,EAAN,CAAS6D,MAAT,CAAgBxB,UAAU,CAAC7J,KAAD,CAA1B;EACD,OAFD;EAGD;EACF,GAVD,MAUO;EACLkL,IAAAA,KAAK,CAAC1D,EAAN,GAAW2D,QAAQ,CAACG,cAAT,CAAwB/F,IAAxB,CAAX;EACD;;EACD,SAAO2F,KAAK,CAAC1D,EAAb;EACD;;EAGD,SAAS2C,gBAAT,CAA0Be,KAA1B,EAAgD;EAAA,MAAfK,QAAe,uEAAJ,EAAI;EAC9C,MAAMC,QAAQ,GAAGN,KAAK,CAAClJ,IAAN,IAAc,EAA/B;EACA,MAAIwF,EAAE,GAAG0D,KAAK,CAAC1D,EAAf,CAF8C;;EAI9C,MAAIiE,QAAQ,GAAGD,QAAQ,CAACE,KAAT,IAAkB,EAAjC;EACA,MAAIC,QAAQ,GAAGJ,QAAQ,CAACG,KAAT,IAAkB,EAAjC,CAL8C;;EAQ9C,OAAK,IAAIxL,GAAT,IAAgByL,QAAhB,EAA0B;EACxB,QAAI,CAACF,QAAQ,CAACvL,GAAD,CAAb,EAAoB;EAClBuL,MAAAA,QAAQ,CAACvL,GAAD,CAAR,GAAgB,EAAhB;EACD;EACF,GAZ6C;;;EAe9C,OAAK,IAAIA,IAAT,IAAgBqL,QAAhB,EAA0B;EACxB,QAAI,CAACC,QAAQ,CAACtL,IAAD,CAAb,EAAoB;EAClBsH,MAAAA,EAAE,CAACoE,eAAH,CAAmB1L,IAAnB;EACD;EACF;;EACD,OAAK,IAAIA,KAAT,IAAgBsL,QAAhB,EAA0B;EACxB;EACA,QAAItL,KAAG,KAAK,OAAZ,EAAqB;EACnB,WAAK,IAAI2L,SAAT,IAAsBL,QAAQ,CAACE,KAA/B,EAAsC;EACpClE,QAAAA,EAAE,CAACkE,KAAH,CAASG,SAAT,IAAsBL,QAAQ,CAACE,KAAT,CAAeG,SAAf,CAAtB;EACD;EACF,KAJD;EAAA,SAMK;EACH;EACArE,QAAAA,EAAE,CAACsE,YAAH,CAAgB5L,KAAhB,EAAqBsL,QAAQ,CAACtL,KAAD,CAA7B;EACD;EACF;EACF;;ECvJM,SAAS6L,cAAT,CAAwBC,GAAxB,EAA6B;EAClCA,EAAAA,GAAG,CAACzL,SAAJ,CAAc0L,OAAd,GAAwB,UAAUf,KAAV,EAAiB;EACvC,QAAMhI,EAAE,GAAG,IAAX;EACAA,IAAAA,EAAE,CAACgJ,GAAH,GAAS7C,KAAK,CAACnG,EAAE,CAACgJ,GAAJ,EAAShB,KAAT,CAAd;EACD,GAHD;EAID;EAEM,SAASiB,cAAT,CAAwBjJ,EAAxB,EAA4BsE,EAA5B,EAAgC;EACrC;EACA;EACA4E,EAAAA,QAAQ,CAAClJ,EAAD,EAAK,aAAL,CAAR;;EACA,MAAMmJ,eAAe,GAAG,SAAlBA,eAAkB,GAAM;EAC5B;EACA;EACAnJ,IAAAA,EAAE,CAAC+I,OAAH,CAAW/I,EAAE,CAACoJ,OAAH,EAAX;EACD,GAJD,CAJqC;;;EAUrC,MAAI1D,OAAJ,CAAY1F,EAAZ,EAAgBmJ,eAAhB,EAAiC,YAAM,EAAvC,EAA2C,IAA3C;EACAD,EAAAA,QAAQ,CAAClJ,EAAD,EAAK,SAAL,CAAR;EACD;;EAGM,SAASkJ,QAAT,CAAkBlJ,EAAlB,EAAsBrD,IAAtB,EAA4B;EACjC,MAAI0M,QAAQ,GAAGrJ,EAAE,CAACE,QAAH,CAAYvD,IAAZ,CAAf,CADiC;;EAEjC,MAAI0M,QAAJ,EAAc;EACZ,SAAK,IAAIhG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgG,QAAQ,CAAClH,MAA7B,EAAqCkB,CAAC,EAAtC,EAA0C;EACxC;EACAgG,MAAAA,QAAQ,CAAChG,CAAD,CAAR,CAAY1C,IAAZ,CAAiBX,EAAjB;EACD;EACF;EACF;;EC5BM,SAASsJ,SAAT,CAAmBR,GAAnB,EAAwB;EAC7BA,EAAAA,GAAG,CAACzL,SAAJ,CAAckM,KAAd,GAAsB,UAAUxM,OAAV,EAAmB;EACvC,QAAMiD,EAAE,GAAG,IAAX,CADuC;;EAGvCA,IAAAA,EAAE,CAACE,QAAH,GAActD,YAAY,CAACoD,EAAE,CAACwJ,WAAH,CAAezM,OAAhB,EAAyBA,OAAzB,CAA1B;EACAmM,IAAAA,QAAQ,CAAClJ,EAAD,EAAK,cAAL,CAAR;EACAD,IAAAA,SAAS,CAACC,EAAD,CAAT;EACAkJ,IAAAA,QAAQ,CAAClJ,EAAD,EAAK,SAAL,CAAR,CANuC;;EAQvC,QAAIA,EAAE,CAACE,QAAH,CAAYoE,EAAhB,EAAoB;EAClBtE,MAAAA,EAAE,CAACyJ,MAAH,CAAUzJ,EAAE,CAACE,QAAH,CAAYoE,EAAtB;EACD,KAVsC;;EAYxC,GAZD;;EAaAwE,EAAAA,GAAG,CAACzL,SAAJ,CAAcoM,MAAd,GAAuB,UAAUnF,EAAV,EAAc;EACnC,QAAMtE,EAAE,GAAG,IAAX;EACA,QAAMjD,OAAO,GAAGiD,EAAE,CAACE,QAAnB;EACAF,IAAAA,EAAE,CAACgJ,GAAH,GAASf,QAAQ,CAACyB,aAAT,CAAuBpF,EAAvB,CAAT,CAHmC;;EAKnC,QAAI,CAACvH,OAAO,CAAC8H,MAAb,EAAqB;EACnB,UAAIF,QAAQ,GAAG3E,EAAE,CAACE,QAAH,CAAYyE,QAA3B,CADmB;;EAGnB,UAAI,CAACA,QAAD,IAAa3E,EAAE,CAACgJ,GAApB,EAAyB;EACvBrE,QAAAA,QAAQ,GAAG3E,EAAE,CAACgJ,GAAH,CAAOW,SAAlB;EACD;;EACD,UAAM9E,MAAM,GAAGH,kBAAkB,CAACC,QAAD,CAAjC;EACA5H,MAAAA,OAAO,CAAC8H,MAAR,GAAiBA,MAAjB;EACArE,MAAAA,OAAO,CAACC,GAAR,CAAY1D,OAAO,CAAC8H,MAApB;EACD,KAdkC;;;EAgBnCoE,IAAAA,cAAc,CAACjJ,EAAD,EAAKA,EAAE,CAACgJ,GAAR,CAAd;EACD,GAjBD;EAkBD;;ECrCM,SAASY,eAAT,CAAyBvH,IAAzB,EAA+B;EACpC,SAAO2F,KAAK,CAAC6B,SAAD,EAAYA,SAAZ,EAAuBA,SAAvB,EAAkCA,SAAlC,EAA6CxH,IAA7C,CAAZ;EACD;EAEM,SAAS6F,aAAT,CAAuBvG,GAAvB,EAAoD;EAAA,MAAxB7C,IAAwB,uEAAjB,EAAiB;;EAAA,oCAAV8C,QAAU;EAAVA,IAAAA,QAAU;EAAA;;EACzD;EACA;EACA;EACA;EACA,SAAOoG,KAAK,CAACrG,GAAD,EAAM7C,IAAN,EAAYA,IAAI,CAAC9B,GAAjB,EAAsB4E,QAAtB,CAAZ;EACD;;EAED,SAASoG,KAAT,CAAerG,GAAf,EAAoB7C,IAApB,EAA0B9B,GAA1B,EAA+B4E,QAA/B,EAAyCS,IAAzC,EAA+C;EAC7C,SAAO;EACLV,IAAAA,GAAG,EAAHA,GADK;EAEL7C,IAAAA,IAAI,EAAJA,IAFK;EAGL9B,IAAAA,GAAG,EAAHA,GAHK;EAIL4E,IAAAA,QAAQ,EAARA,QAJK;EAKLS,IAAAA,IAAI,EAAJA;EALK,GAAP;EAOD;;EClBM,SAASyH,WAAT,CAAqBhB,GAArB,EAA0B;EAC/BA,EAAAA,GAAG,CAACzL,SAAJ,CAAc0M,EAAd,GAAmB,UAAU1H,IAAV,EAAgB;EACjC,WAAOuH,eAAe,CAACvH,IAAD,CAAtB;EACD,GAFD,CAD+B;;;EAK/ByG,EAAAA,GAAG,CAACzL,SAAJ,CAAc2M,EAAd,GAAmB,YAAY;EAC7B,WAAO9B,aAAa,MAAb,SAAiB+B,SAAjB,CAAP;EACD,GAFD,CAL+B;;;EAS/BnB,EAAAA,GAAG,CAACzL,SAAJ,CAAc6M,EAAd,GAAmB,UAAUC,GAAV,EAAe;EAChC,WAAOA,GAAG,IAAI,IAAP,GACH,EADG,GAEH,QAAOA,GAAP,MAAe,QAAf,GACA1G,IAAI,CAACC,SAAL,CAAeyG,GAAf,CADA,GAEAA,GAJJ;EAKD,GAND;;EAOArB,EAAAA,GAAG,CAACzL,SAAJ,CAAc+L,OAAd,GAAwB,YAAY;EAClC5I,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;EACA,QAAMT,EAAE,GAAG,IAAX;EAFkC,QAG1B6E,MAH0B,GAGf7E,EAAE,CAACE,QAHY,CAG1B2E,MAH0B;;EAMlC,QAAMmD,KAAK,GAAGnD,MAAM,CAAClE,IAAP,CAAY,IAAZ,CAAd;EACAH,IAAAA,OAAO,CAACC,GAAR,CAAYuH,KAAZ;EACA,WAAOA,KAAP;EACD,GATD;EAUD;;EC3BM,SAASoC,aAAT,CAAuBtB,GAAvB,EAA4B;EACjCA,EAAAA,GAAG,CAAC/L,OAAJ,GAAc,EAAd,CADiC;EAEjC;;EACA+L,EAAAA,GAAG,CAACuB,KAAJ,GAAY,UAAUA,KAAV,EAAiB;EAC3B,SAAKtN,OAAL,GAAeH,YAAY,CAAC,KAAKG,OAAN,EAAesN,KAAf,CAA3B;EACA7J,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAK1D,OAAjB;EACD,GAHD;EAID;;ECFD,SAAS+L,GAAT,CAAa/L,OAAb,EAAsB;EACpB,OAAKwM,KAAL,CAAWxM,OAAX;EACD;;EAEDuM,SAAS,CAACR,GAAD,CAAT;;EACAgB,WAAW,CAAChB,GAAD,CAAX;;EACAD,cAAc,CAACC,GAAD,CAAd;;EACAsB,aAAa,CAACtB,GAAD,CAAb;;EACAA,GAAG,CAACzL,SAAJ,CAAciN,SAAd,GAA0BpF,QAA1B;;EAKA,IAAIqF,GAAG,GAAG,IAAIzB,GAAJ,CAAQ;EAAEhK,EAAAA,IAAI,EAAE;EAAEmE,IAAAA,IAAI,EAAE;EAAR;EAAR,CAAR,CAAV;EACA,IAAIuH,GAAG,GAAG,IAAI1B,GAAJ,CAAQ;EAAEhK,EAAAA,IAAI,EAAE;EAAEmE,IAAAA,IAAI,EAAE;EAAR;EAAR,CAAR,CAAV;EAEA,IAAIwH,OAAO,GAAG/F,kBAAkB,mLAAhC;EAQA,IAAI0B,QAAQ,GAAGqE,OAAO,CAAC9J,IAAR,CAAa4J,GAAb,CAAf;EACA,IAAIG,WAAW,GAAG/D,UAAU,CAACP,QAAD,CAA5B;EACA6B,QAAQ,CAAC0C,IAAT,CAAcrD,WAAd,CAA0BoD,WAA1B;EAEA,IAAIE,OAAO,GAAGlG,kBAAkB,iOAAhC;EASA,IAAI2B,QAAQ,GAAGuE,OAAO,CAACjK,IAAR,CAAa6J,GAAb,CAAf;EACAhF,UAAU,CAAC,YAAM;EACfW,EAAAA,KAAK,CAACC,QAAD,EAAWC,QAAX,CAAL;EACD,CAFS,EAEP,IAFO,CAAV;;;;;;;;"}